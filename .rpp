#!/bin/sh
#
# rperre's PROMPT
# This should be included on your bash profile script
#

branch() {
	B=`git branch 2> /dev/null | sed -e '/^[^*]/d' -e 's/* \(.*\)/\1/'`
	if [ "$B" != "" ]
	then
		echo "{$(basename `pwd`)/${B//[[:blank:]]/}}"
	fi

}

modified() {
	M=`git ls-files -m 2> /dev/null | wc -l`
	if [ "$M" -gt "0" ]
	then

		echo " M:${M//[[:blank:]]/}"
	fi
}

untracked() {
	U=`git ls-files --others --exclude-standard 2> /dev/null | wc -l`
	if [ "$U" -gt "0" ]
	then
		echo " U:${U//[[:blank:]]/}"
	fi
}


git_folder() {
	B=`git branch 2> /dev/null | sed -e '/^[^*]/d' -e 's/* \(.*\)/\1/'`
	if [ "$B" != "" ]
	then
		echo ""
		echo "[G]"
	fi
}

normal_folder() {
	B=`git branch 2> /dev/null | sed -e '/^[^*]/d' -e 's/* \(.*\)/\1/'`
	if [ "$B" = "" ]
	then
		echo "[L]"
	fi	
}

staged() {
	S=`git diff --cached --numstat 2> /dev/null | wc -l`
	if [ "$S" -gt "0" ]
	then
		echo " S:${S//[[:blank:]]/}"
	fi
}

uncommited() {
	S=`git log --branches --not --remotes 2> /dev/null | grep "commit "| wc -l`
	if [ "$S" -gt "0" ]
	then
		echo " NEEDS PUSH!(${S//[[:blank:]]/})"
	fi	
}

A='$(branch)'
B='$(modified)'
C='$(untracked)'
D='$(git_folder)'
E='$(normal_folder)'
F='$(staged)'
G='$(uncommited)'

SH_RESET="\e[0m"

SH_WHITE="\[\033[1;37m\]"
SH_BLUE="\[\033[1;34m\]"
SH_RED="\[\033[1;31m\]"
SH_GREEN="\[\033[1;32m\]"
SH_YELLOW="\[\033[1;33m\]"

BL_ANGLE="\342\224\224"
TL_ANGLE="\342\224\214"
HORIZ_LINE="\342\224\200"

BRANCH_COLOR="$SH_BLUE"
MODIFIED_COLOR="$SH_YELLOW"
UNTRACKED_COLOR="$SH_YELLOW"
GITFOLDER_COLOR="$SH_YELLOW"
NORMALFOLDER_COLOR="$SH_GREEN"
STAGED_COLOR="$SH_GREEN"
UNPUSHED_COLOR="$SH_RED"

PS1="${BRANCH_COLOR}$A${MODIFIED_COLOR}$B${UNTRACKED_COLOR}$C${STAGED_COLOR}$F${UNPUSHED_COLOR}$G${GITFOLDER_COLOR}$D${NORMALFOLDER_COLOR}$E${SH_WHITE}[$USER]$ ${SH_RESET}"

