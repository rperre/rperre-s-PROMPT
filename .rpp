#!/bin/sh
#
# 									rperre's PROMPT
# This should be included on your bash profile script
#
get_git() {
	GITBRANCH=`git branch 2> /dev/null | sed -e '/^[^*]/d' -e 's/* \(.*\)/\1/'`
	if [ "$GITBRANCH" != "" ]
	then
		# Its a GIT folder

		# Get untacked files
		UNTRACKED=`git ls-files --others --exclude-standard 2> /dev/null | wc -l`

		# Get modified files
		MODIFIED=`git ls-files -m 2> /dev/null | wc -l`

		# Get GIT name
		GITNAME="$(basename `pwd`)"

		echo "\033[01;32m\]{$GITNAME/$GITBRANCH} \033[00m\]Modifed:\033[01;31m\]$MODIFIED \033[00m\]Untracked:\033[01;31m\]$UNTRACKED\033[00m\]\n\033[00;33m\][G]\[\033[00m\][$USER@$HOST]\[\033[00m\]$ "

	else
		# Its NOT a GIT folder
		echo "\033[01;32m\][L]\[\033[00m\][$USER@$HOST]\[\033[00m\]$ "
	fi
}


git_branch () { git branch 2> /dev/null | sed -e '/^[^*]/d' -e 's/* \(.*\)/\1/'; }

PREFIX=""

up_output() {
	O=""
	M=`git ls-files -m 2> /dev/null | wc -l`
	U=`git ls-files --others --exclude-standard 2> /dev/null | wc -l`
	B=`git branch 2> /dev/null | sed -e '/^[^*]/d' -e 's/* \(.*\)/\1/'`
	if [ "$B" != "" ]
	then
	       O="Branch: $B"
	fi

	U=`git ls-files --others --exclude-standard 2> /dev/null | wc -l`
	if [ "$U" -gt "0" ]
	then
		O="$O | Untracked:$U"
	fi

	M=`git ls-files -m 2> /dev/null | wc -l`
	if [ "$M" -gt "0" ]
	then
		O="$O | Modified:$M"
	fi

	if [ "$O" != "" ]
	then
		A=$(basename `pwd`)
		echo "{$A} - $O"
		echo '[G]'
	else
		echo '[L]'
	fi

}

HOST='\033[02;36m\]\h';
#TIME='\033[01;31m\]\t \033[01;32m\]'
LOCATION=' \033[01;34m\]`pwd | sed "s#\(/[^/]\{1,\}/[^/]\{1,\}/[^/]\{1,\}/\).*\(/[^/]\{1,\}/[^/]\{1,\}\)/\{0,1\}#\1_\2#g"`'
BRANCH='\033[00;33m\]$(up_output)\[\033[00m\]\'


PS1="$BRANCH[[$USER@$HOST\[\033[00m\]]$ "
